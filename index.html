<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Racerdroid : A tool to detect concurrency bugs in Android applications">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Racerdroid</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/midori1/RacerDroid">View on GitHub</a>

          <h1 id="project_title">Racerdroid</h1>
          <h2 id="project_tagline">A tool to detect concurrency bugs in Android applications</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/midori1/RacerDroid/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/midori1/RacerDroid/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="racerdroid" class="anchor" href="#racerdroid" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>RacerDroid</h1>

<h3>
<a id="introduction" class="anchor" href="#introduction" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Introduction</h3>

<p>This is a site to display the test result of RacerDroid. We perform RacerDroid on several open source applications to evaluate the feasibility of the technique. The numerical result is shown in the table.</p>

<table>
<thead>
<tr>
<th>Subject</th>
<th>Components</th>
<th># of potential data races</th>
<th>TP</th>
<th>FP</th>
<th>TP (manual)</th>
<th>FP (manual)</th>
</tr>
</thead>
<tbody>
<tr>
<td>ToDoWidget</td>
<td>ColorCircle</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
<td>1</td>
</tr>
<tr>
<td>ConnectBot</td>
<td>HostEditorActivity</td>
<td>5</td>
<td>2</td>
<td>3</td>
<td>2</td>
<td>3</td>
</tr>
<tr>
<td>ConnectBot</td>
<td>HostListActivity</td>
<td>4</td>
<td>2</td>
<td>2</td>
<td>2</td>
<td>2</td>
</tr>
<tr>
<td>ConnectBot</td>
<td>PubkeyListActivity</td>
<td>4</td>
<td>0</td>
<td>4</td>
<td>0</td>
<td>4</td>
</tr>
<tr>
<td>ConnectBot</td>
<td>TerminalManager</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>2</td>
<td>0</td>
</tr>
<tr>
<td>AnyMemo</td>
<td>DownloaderAnyMemo</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>MyTrack</td>
<td>MyTracks/TrackRecordingService</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>OI File Manager</td>
<td>FileListManager</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>

<p>The following sections describe the details of each case.</p>

<h3>
<a id="anymemo" class="anchor" href="#anymemo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>AnyMemo</h3>

<p><a href="http://anymemo.org/">AnyMemo</a> is a free open-sourced spaced repetition flashcard learning software similar to SuperMemo for Android mobile phones. We use test it on version 10.2 whose code can be downloaded in <a href="https://github.com/helloworld1/AnyMemo">https://github.com/helloworld1/AnyMemo</a>.</p>

<p>The example in the figure shows the segment codes that are related to this race. When <code>DownloaderAnyMemo</code>(the activity used to download the data bases) is shown to the user, <code>onCreate()</code> will invoke <code>initialRetrieve()</code> which create a background thread that downloads data. During the downloading, the user is notified about the progress using a <code>ProgressDialog</code> component. After the downloading task is finish, a message include a <code>Runnable</code> object will be posted to the message queue indicates the downloading is finish and the data will be displayed to the user. </p>

<p><img src="https://static.oschina.net/uploads/img/201605/04145607_bXVh.png" alt="a code snippet of AnyMemo releated to the data race" title="A code segment of AnyMemo"></p>

<p>The result of analyzer shows that the run method and the <code>onDestroy()</code> callback of the activity have races as when the background is finish after <code>onDestroy()</code> is executed. From the code we know that this bug is result from the execution of <code>mDialog.dismiss()</code> and the system will throw an exception: “java.lang.IllegalArgumentException: View not attached to window manager” because this method is trying to remove the ProgressDialog view which is no longer attached to the window manager.</p>

<p>As our test case generation tool is still developing, in order to confirm this potential data race, we first generate a test case manually that will trigger these two callbacks. The figure below shows the corresponding test case. This test case first turns to the download activity (<code>DownloaderAnyMemo</code>) and starts the download background thread immediately , waits until the download is end and rotate the screen (this will call <code>onDestroy()</code>) and at last check if it runs as expected. In the base schedule, the run method in the finish message will run before <code>onDestory()</code>.</p>

<p><img src="https://static.oschina.net/uploads/img/201605/04151445_XE9U.png" alt="the test case of AnyMemo" title="the test case of AnyMemo"></p>

<p>As <code>onDestroy()</code> and <code>run()</code> are both invoked by the framework asynchronously, RacerDroid will replay the generated test case by reordering the two events with the sequence that <code>onDestory()</code> runs before <code>onPostExecute()</code>. In this schedule, the exception will be thrown, making the app crash.</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Racerdroid maintained by <a href="https://github.com/midori1">midori1</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
